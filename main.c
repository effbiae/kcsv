#include"___.h"

K csv(K x);extern U sz(K x,U n);

K k(K x,K y,K z){
	P(x==1,x)P(x==32,y=8+calloc(8+y*8,1),yn=y,y)
	printf("k() x=%d y=%d\n",(G)x,(UI)y);}

Zin U uS(UI n,S s){R!n?0:*(U*)s&~0ULL>>64-8*min(8,n);}//Zin ZU sz(K x,U n){U r=NT[xt]*n;printf("SZ %d\n",r);R r;}

#define KC(x,s) {UI sn=strlen(s);K r=8+calloc(1,8+sn);rn=sn,rt=KC,memcpy(rG,s,sn);x=r;}

S file="/Users/kelas/EQY_US_ALL_TRADE_20201210",frmt="|QsssifsgijssQQb";
const I CCT=15;S cnames[CCT]={"tme","xch","sym","cnd","vol","trd","stp","crr","seq","tid","src","rpt","ptm","rtm","xpt"};

int main(){K x,y,z;
	KC(x,file);KC(y,frmt);
	z=8+calloc(1,8+sizeof(U)*CCT);zn=CCT,zt=KS;N(CCT,S s=cnames[i];zU[i]=uS(strlen(s),s))
	K r;{K x=8+calloc(1,8+8*5);xn=5;xt=0;r=x;}
	rU[0]=x,rU[1]=y,rU[2]=z,rU[3]=sysconf(_SC_NPROCESSORS_ONLN)/2,rU[4]=0;
	csv(r);}

//:~